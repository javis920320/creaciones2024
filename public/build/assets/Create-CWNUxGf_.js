import{j as e,r as i,b as N,W as F,a as A,Y as R}from"./app-CHCnxYMc.js";import{A as B}from"./AuthenticatedLayout--eb1OftY.js";import{S as k}from"./SelectList-Ds1XbXlJ.js";import{S as L}from"./SecondaryButton-8AtDTDyl.js";import{I as p}from"./InputLabel-BJ5U4-nt.js";import{P as T}from"./PrimaryButton-DxSz9uwy.js";import{T as q}from"./TextInput-C9G2yIA4.js";import{I as f}from"./InputError-DIr6nBQC.js";import{q as M}from"./transition-9fSJeNXa.js";import{C as D,a as w}from"./CardContent-C4nXz7YU.js";import{D as O,a as V,b as $,c as z}from"./DialogTitle-Cyh40x3k.js";import{B as J}from"./Button-jvpFXlr5.js";import"./ApplicationLogo-vURMMc94.js";import"./DefaultPropsProvider-cycn9cZQ.js";import"./clsx-B-dksMZM.js";import"./Paper-pE01Sojy.js";import"./useForkRef-DUgWzJfa.js";import"./useSlotProps-B-q5SyJT.js";const y=({className:a="",...t})=>e.jsx("input",{...t,type:"radio",className:"rounded dark:bg-gray-900 border-gray-300 dark:border-gray-700 text-indigo-600 shadow-sm focus:ring-indigo-500 dark:focus:ring-indigo-600 dark:focus:ring-offset-gray-800 "+a}),W=({empleados:a,orden:t})=>{const[d,l]=i.useState([]),[m,c]=i.useState(0),[o,E]=i.useState(""),[g,j]=i.useState();i.useEffect(()=>{N.get(route("asignacionesocupadas",t.id)).then(s=>c(s.data))},[]),i.useEffect(()=>{N(route("productos.categoria",t.categoriaId)).then(s=>l(s.data))},[]);const{data:h,setData:x,post:v,errors:u,setError:C,recentlySuccessful:r,processing:S,reset:K}=F({order_id:(t==null?void 0:t.id)||null,empleado_id:""}),_=s=>{const n=s.target.value,P=a.find(b=>b.id==n);j(P.cargo),x(b=>({...b,empleado_id:s.target.value}))},I=s=>{s.preventDefault(),N.post(route("asignacion.store"),h).then(n=>{n.data.errors&&C(n.data.errors)}).catch(n=>{n.response?console.error("Error del servidor:",n.response.data):n.request?console.error("No se recibió respuesta:",n.request):console.error(JSON.stringify(n))})};return e.jsxs("div",{children:[e.jsxs("form",{onSubmit:I,children:[d.length>0?e.jsxs("div",{children:[e.jsx(p,{children:"Producto"}),e.jsxs(k,{onChange:s=>x("producto",s.target.value),className:"w-1/2",children:[e.jsxs("option",{disabled:!0,selected:!0,children:["Seleccione"," "]}),d.map(({nameProduct:s,id:n})=>e.jsx("option",{value:n,children:s}))]})]}):e.jsx("h2",{className:"text-red-500",children:"No hay productos disponibles para esta categoria"}),e.jsxs("div",{children:[e.jsx(p,{children:"Lista de trabajadores "}),e.jsxs(k,{onChange:_,name:"tipoempleado",children:[e.jsx("option",{children:"Asignar a:"}),a.map(s=>e.jsxs("option",{value:s.id,children:[s.nombreCompleto," ",s.cargo]},s.id))]}),e.jsx(f,{message:u.empleado_id})]}),e.jsxs("div",{children:[e.jsx(p,{children:"Cantidad asignada"}),e.jsx(q,{type:"number",onChange:s=>x("cantidad",s.target.value),min:1,max:t?t.cantidad-m:null}),e.jsx(f,{message:u.cantidad})]}),g=="Operador Externo"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(p,{children:"Costo Externo"}),e.jsx(y,{name:"tipocosto",id:"externo_normal",onChange:s=>x("tipocosto",s.target.id)})]}),e.jsxs("div",{children:[e.jsx(p,{children:"Sin Costo "}),e.jsx(y,{name:"tipocosto",id:"sincosto",onChange:s=>x("tipocosto",s.target.id)})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(p,{children:"Costo Normal"}),e.jsx(y,{name:"tipocosto",id:"operador_normal",onChange:s=>x("tipocosto",s.target.id)})]}),e.jsxs("div",{children:[e.jsx(p,{children:"Costo Extra"}),e.jsx(y,{name:"tipocosto",id:"hora_extra",onChange:s=>x("tipocosto",s.target.id)})]}),e.jsxs("div",{children:[e.jsx(p,{children:"Sin Costo "}),e.jsx(y,{name:"tipocosto",id:"sincosto",onChange:s=>x("tipocosto",s.target.id)})]})]}),e.jsx(f,{message:u.order_id}),e.jsx(f,{message:u.fecha_asignacion}),e.jsx(f,{message:u.tipocosto}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(T,{disabled:S,children:[" ",S?"Enviando...":"Enviar"]}),e.jsx(M,{show:r,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Asignar"})})]})]}),o&&e.jsx("p",{className:"text-green-500",children:o})]})},Y=({orden:a})=>{const[t,d]=i.useState([]),l=c=>{N(route("asignacion.listar",c)).then(o=>d(o.data))};i.useEffect(()=>{l(a.id)},[a.id]);let m=t==null?void 0:t.reduce((c,o)=>c+(o.cantidad||0),0);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg  flex justify-between items-center gap-3",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:["Asignados: ",e.jsxs("span",{className:"text-green-600 dark:text-green-400 font-bold",children:[m,"/",a.cantidad]})]}),e.jsx(A,{href:route("asignacion.listado",a.id),className:"text-blue-600 dark:text-blue-400 font-semibold hover:underline",children:"Ver asignaciónes"})]})},G=({pedido:a})=>{const{ordenes:t,cliente:d,factura:l,fechaEntrega:m,envioDomicilio:c,estado:o}=a;return e.jsx(D,{sx:{borderLeft:"2px",borderRadius:"1rem"},children:e.jsx(w,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Información del Cliente"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Número Factura:"})," ","Fac-",l]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Cliente:"})," ",d.identification_number," -"," ",d.full_name]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Entrega:"})," ",m||"Fecha no establecida"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Estado:"})," ",o]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("span",{className:"font-medium",children:"Envío Domicilio:"})," ",c?"Envío Solicitado":"No solicitado"]})]})})})};function H(){const[a,t]=i.useState([]),[d,l]=i.useState(!0),[m,c]=i.useState(null);i.useEffect(()=>{let g=!0;return(async()=>{try{l(!0);const h=await N.get(route("categorias"));g&&(t(h.data.categorias),l(!1))}catch(h){g&&(c(h.message),l(!1))}})(),()=>{g=!1}},[]);const o=i.useMemo(()=>a,[a]);return{categorias:o,inforCategoria:g=>{const j=o.find(h=>h.id===g);return j?j.nameCategory:"Categoría no encontrada"}}}const he=({auth:a,empleados:t,pedido:d})=>{const{categorias:l,inforCategoria:m}=H(),{ordenes:c,cliente:o,factura:E,fechaEntrega:g,envioDomicilio:j,estado:h}=d.data[0],[x,v]=i.useState(!1),[u,C]=i.useState();return e.jsxs(B,{user:a.user,header:e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:["Asignación de Pedidos"," ",e.jsx(A,{className:"text-indigo-400 hover:text-indigo-600",href:"/asignacion",children:"/ Lista Pedidos"})]}),children:[e.jsx(R,{title:"Asignar Pedidos"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4",children:[e.jsx("div",{className:"grid-cols-subgrid col-span-1 row-span-4",children:e.jsx(G,{pedido:d.data[0]})}),e.jsx("div",{className:"col-span-3 grid grid-cols-1 gap-6",children:e.jsx(D,{sx:{borderRadius:"1rem"},children:e.jsx(w,{children:e.jsx("form",{className:"space-y-6",children:c.map(r=>e.jsx("div",{className:`border p-4 rounded-lg transition-all duration-300 ${r.estado==="completado"?"border-green-500 bg-green-50":"border-gray-200 bg-white"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-center",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("img",{src:"/placeholder.svg",alt:"Producto",width:64,height:64,className:"rounded-md",style:{aspectRatio:"64/64",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:r.producto}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Descripción:"," ",r.descripcion]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Talla: ",r.talla]})]})]}),e.jsxs("div",{className:"text-right space-y-3",children:[e.jsxs("p",{className:"text-gray-800 font-medium",children:["Categoría:",m(r.categoriaId)]}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Cantidad: ",r.cantidad]}),e.jsxs("p",{className:`text-sm font-medium ${r.estado==="creado"?"text-yellow-500":r.estado==="procesando"?"text-blue-500":r.estado==="completado"?"text-green-500":"text-red-500"}`,children:["Estado: ",r.estado]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(L,{onClick:()=>{C(r),v(!0)},children:"Asignar Pedido"}),e.jsx(Y,{orden:r})]})]})]})},r.id))})})})})]}),e.jsxs(O,{open:x,onClose:()=>v(!1),children:[e.jsx(V,{children:"Registrar Asignacion"}),e.jsxs($,{children:[e.jsx("h1",{className:"text-gray-500",children:"Asignacion y costos de elaboracion"}),e.jsx(W,{empleados:t,orden:u})]}),e.jsx(z,{children:e.jsx(J,{onClick:()=>v(!1),children:"Cancelar"})})]})]})};export{he as default};
