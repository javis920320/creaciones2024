import{r as c,e as Q,j as u,y as K,Y as Z,b as ee}from"./app-DNyFTp_I.js";import{A as te}from"./AuthenticatedLayout-BnJvsuQ8.js";import{S as re}from"./Section-CM1bJzKz.js";import{c as _}from"./clsx-B-dksMZM.js";import{T as ae}from"./TextInput-XZFMSyYV.js";import{l as ne}from"./index-DezAKa5j.js";import{l as P,o as b,O as H,U as N,y as F,s as se,u as Y,d as E,C as T,p as J,a as oe,b as L}from"./transition-CrWVsblw.js";import{o as ie,y as le,h as ue,T as ce,I as O,a as x,r as de,n as me,_ as fe,M as V,D as X,b as pe}from"./keyboard-Djch_ItY.js";import"./ApplicationLogo-BoN71fHg.js";function q(e){var a;if(e.type)return e.type;let t=(a=e.as)!=null?a:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function ge(e,a){let[t,n]=c.useState(()=>q(e));return P(()=>{n(q(e))},[e.type,e.as]),P(()=>{t||a.current&&a.current instanceof HTMLButtonElement&&!a.current.hasAttribute("type")&&n("button")},[t,a]),t}function z(e){return[e.screenX,e.screenY]}function xe(){let e=c.useRef([-1,-1]);return{wasMoved(a){let t=z(a);return e.current[0]===t[0]&&e.current[1]===t[1]?!1:(e.current=t,!0)},update(a){e.current=z(a)}}}function ve({container:e,accept:a,walk:t,enabled:n=!0}){let o=c.useRef(a),r=c.useRef(t);c.useEffect(()=>{o.current=a,r.current=t},[a,t]),P(()=>{if(!e||!n)return;let l=ie(e);if(!l)return;let s=o.current,m=r.current,f=Object.assign(h=>s(h),{acceptNode:s}),g=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,f,!1);for(;g.nextNode();)m(g.currentNode)},[e,n,o,r])}function ye(e){throw new Error("Unexpected object: "+e)}var k=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(k||{});function he(e,a){let t=a.resolveItems();if(t.length<=0)return null;let n=a.resolveActiveIndex(),o=n??-1;switch(e.focus){case 0:{for(let r=0;r<t.length;++r)if(!a.resolveDisabled(t[r],r,t))return r;return n}case 1:{for(let r=o-1;r>=0;--r)if(!a.resolveDisabled(t[r],r,t))return r;return n}case 2:{for(let r=o+1;r<t.length;++r)if(!a.resolveDisabled(t[r],r,t))return r;return n}case 3:{for(let r=t.length-1;r>=0;--r)if(!a.resolveDisabled(t[r],r,t))return r;return n}case 4:{for(let r=0;r<t.length;++r)if(a.resolveId(t[r],r,t)===e.id)return r;return n}case 5:return null;default:ye(e)}}let W=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function G(e){var a,t;let n=(a=e.innerText)!=null?a:"",o=e.cloneNode(!0);if(!(o instanceof HTMLElement))return n;let r=!1;for(let s of o.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))s.remove(),r=!0;let l=r?(t=o.innerText)!=null?t:"":n;return W.test(l)&&(l=l.replace(W,"")),l}function be(e){let a=e.getAttribute("aria-label");if(typeof a=="string")return a.trim();let t=e.getAttribute("aria-labelledby");if(t){let n=t.split(" ").map(o=>{let r=document.getElementById(o);if(r){let l=r.getAttribute("aria-label");return typeof l=="string"?l.trim():G(r).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return G(e).trim()}function Ie(e){let a=c.useRef(""),t=c.useRef("");return b(()=>{let n=e.current;if(!n)return"";let o=n.innerText;if(a.current===o)return t.current;let r=be(n).trim().toLowerCase();return a.current=o,t.current=r,r})}var Se=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Se||{}),ke=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ke||{}),Re=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(Re||{});function $(e,a=t=>t){let t=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=pe(a(e.items.slice()),r=>r.dataRef.current.domRef.current),o=t?n.indexOf(t):null;return o===-1&&(o=null),{items:n,activeItemIndex:o}}let De={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,a)=>{var t;let n=$(e),o=he(a,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:r=>r.id,resolveDisabled:r=>r.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:o,activationTrigger:(t=a.trigger)!=null?t:1}},3:(e,a)=>{let t=e.searchQuery!==""?0:1,n=e.searchQuery+a.value.toLowerCase(),o=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+t).concat(e.items.slice(0,e.activeItemIndex+t)):e.items).find(l=>{var s;return((s=l.dataRef.current.textValue)==null?void 0:s.startsWith(n))&&!l.dataRef.current.disabled}),r=o?e.items.indexOf(o):-1;return r===-1||r===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:r,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,a)=>{let t=$(e,n=>[...n,{id:a.id,dataRef:a.dataRef}]);return{...e,...t}},6:(e,a)=>{let t=$(e,n=>{let o=n.findIndex(r=>r.id===a.id);return o!==-1&&n.splice(o,1),n});return{...e,...t,activationTrigger:1}}},U=c.createContext(null);U.displayName="MenuContext";function A(e){let a=c.useContext(U);if(a===null){let t=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,A),t}return a}function Me(e,a){return Y(a.type,De,e,a)}let Pe=c.Fragment;function je(e,a){let{__demoMode:t=!1,...n}=e,o=c.useReducer(Me,{__demoMode:t,menuState:t?0:1,buttonRef:c.createRef(),itemsRef:c.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:r,itemsRef:l,buttonRef:s},m]=o,f=F(a);le([s,l],(S,R)=>{var p;m({type:1}),ue(R,ce.Loose)||(S.preventDefault(),(p=s.current)==null||p.focus())},r===0);let g=b(()=>{m({type:1})}),h=c.useMemo(()=>({open:r===0,close:g}),[r,g]),y={ref:f};return Q.createElement(U.Provider,{value:o},Q.createElement(se,{value:Y(r,{0:E.Open,1:E.Closed})},T({ourProps:y,theirProps:n,slot:h,defaultTag:Pe,name:"Menu"})))}let we="button";function Ee(e,a){var t;let n=O(),{id:o=`headlessui-menu-button-${n}`,...r}=e,[l,s]=A("Menu.Button"),m=F(l.buttonRef,a),f=J(),g=b(p=>{switch(p.key){case x.Space:case x.Enter:case x.ArrowDown:p.preventDefault(),p.stopPropagation(),s({type:0}),f.nextFrame(()=>s({type:2,focus:k.First}));break;case x.ArrowUp:p.preventDefault(),p.stopPropagation(),s({type:0}),f.nextFrame(()=>s({type:2,focus:k.Last}));break}}),h=b(p=>{switch(p.key){case x.Space:p.preventDefault();break}}),y=b(p=>{if(de(p.currentTarget))return p.preventDefault();e.disabled||(l.menuState===0?(s({type:1}),f.nextFrame(()=>{var I;return(I=l.buttonRef.current)==null?void 0:I.focus({preventScroll:!0})})):(p.preventDefault(),s({type:0})))}),S=c.useMemo(()=>({open:l.menuState===0}),[l]),R={ref:m,id:o,type:ge(e,l.buttonRef),"aria-haspopup":"menu","aria-controls":(t=l.itemsRef.current)==null?void 0:t.id,"aria-expanded":l.menuState===0,onKeyDown:g,onKeyUp:h,onClick:y};return T({ourProps:R,theirProps:r,slot:S,defaultTag:we,name:"Menu.Button"})}let Ne="div",Fe=H.RenderStrategy|H.Static;function Te(e,a){var t,n;let o=O(),{id:r=`headlessui-menu-items-${o}`,...l}=e,[s,m]=A("Menu.Items"),f=F(s.itemsRef,a),g=me(s.itemsRef),h=J(),y=oe(),S=y!==null?(y&E.Open)===E.Open:s.menuState===0;c.useEffect(()=>{let i=s.itemsRef.current;i&&s.menuState===0&&i!==(g==null?void 0:g.activeElement)&&i.focus({preventScroll:!0})},[s.menuState,s.itemsRef,g]),ve({container:s.itemsRef.current,enabled:s.menuState===0,accept(i){return i.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:i.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(i){i.setAttribute("role","none")}});let R=b(i=>{var D,M;switch(h.dispose(),i.key){case x.Space:if(s.searchQuery!=="")return i.preventDefault(),i.stopPropagation(),m({type:3,value:i.key});case x.Enter:if(i.preventDefault(),i.stopPropagation(),m({type:1}),s.activeItemIndex!==null){let{dataRef:v}=s.items[s.activeItemIndex];(M=(D=v.current)==null?void 0:D.domRef.current)==null||M.click()}X(s.buttonRef.current);break;case x.ArrowDown:return i.preventDefault(),i.stopPropagation(),m({type:2,focus:k.Next});case x.ArrowUp:return i.preventDefault(),i.stopPropagation(),m({type:2,focus:k.Previous});case x.Home:case x.PageUp:return i.preventDefault(),i.stopPropagation(),m({type:2,focus:k.First});case x.End:case x.PageDown:return i.preventDefault(),i.stopPropagation(),m({type:2,focus:k.Last});case x.Escape:i.preventDefault(),i.stopPropagation(),m({type:1}),L().nextFrame(()=>{var v;return(v=s.buttonRef.current)==null?void 0:v.focus({preventScroll:!0})});break;case x.Tab:i.preventDefault(),i.stopPropagation(),m({type:1}),L().nextFrame(()=>{fe(s.buttonRef.current,i.shiftKey?V.Previous:V.Next)});break;default:i.key.length===1&&(m({type:3,value:i.key}),h.setTimeout(()=>m({type:4}),350));break}}),p=b(i=>{switch(i.key){case x.Space:i.preventDefault();break}}),I=c.useMemo(()=>({open:s.menuState===0}),[s]),d={"aria-activedescendant":s.activeItemIndex===null||(t=s.items[s.activeItemIndex])==null?void 0:t.id,"aria-labelledby":(n=s.buttonRef.current)==null?void 0:n.id,id:r,onKeyDown:R,onKeyUp:p,role:"menu",tabIndex:0,ref:f};return T({ourProps:d,theirProps:l,slot:I,defaultTag:Ne,features:Fe,visible:S,name:"Menu.Items"})}let Ae=c.Fragment;function Ce(e,a){let t=O(),{id:n=`headlessui-menu-item-${t}`,disabled:o=!1,...r}=e,[l,s]=A("Menu.Item"),m=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===n:!1,f=c.useRef(null),g=F(a,f);P(()=>{if(l.__demoMode||l.menuState!==0||!m||l.activationTrigger===0)return;let v=L();return v.requestAnimationFrame(()=>{var C,B;(B=(C=f.current)==null?void 0:C.scrollIntoView)==null||B.call(C,{block:"nearest"})}),v.dispose},[l.__demoMode,f,m,l.menuState,l.activationTrigger,l.activeItemIndex]);let h=Ie(f),y=c.useRef({disabled:o,domRef:f,get textValue(){return h()}});P(()=>{y.current.disabled=o},[y,o]),P(()=>(s({type:5,id:n,dataRef:y}),()=>s({type:6,id:n})),[y,n]);let S=b(()=>{s({type:1})}),R=b(v=>{if(o)return v.preventDefault();s({type:1}),X(l.buttonRef.current)}),p=b(()=>{if(o)return s({type:2,focus:k.Nothing});s({type:2,focus:k.Specific,id:n})}),I=xe(),d=b(v=>I.update(v)),i=b(v=>{I.wasMoved(v)&&(o||m||s({type:2,focus:k.Specific,id:n,trigger:0}))}),D=b(v=>{I.wasMoved(v)&&(o||m&&s({type:2,focus:k.Nothing}))}),M=c.useMemo(()=>({active:m,disabled:o,close:S}),[m,o,S]);return T({ourProps:{id:n,ref:g,role:"menuitem",tabIndex:o===!0?void 0:-1,"aria-disabled":o===!0?!0:void 0,disabled:void 0,onClick:R,onFocus:p,onPointerEnter:d,onMouseEnter:d,onPointerMove:i,onMouseMove:i,onPointerLeave:D,onMouseLeave:D},theirProps:r,slot:M,defaultTag:Ae,name:"Menu.Item"})}let $e=N(je),_e=N(Ee),Le=N(Te),Oe=N(Ce),w=Object.assign($e,{Button:_e,Items:Le,Item:Oe});const j=({label:e,onClick:a})=>u.jsx(w.Item,{children:({active:t})=>u.jsx("button",{onClick:a,className:_("group flex rounded-md items-center w-full px-2 py-2 text-sm",t?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-200"),children:e})}),Ue=({row:e})=>u.jsxs(w,{as:"div",className:"relative inline-block text-left",children:[u.jsx(w.Button,{className:"flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none",children:u.jsx(ne,{})}),u.jsx(w.Items,{className:"absolute right-0 mt-2 w-40 bg-white dark:bg-gray-800 divide-y divide-gray-100 dark:divide-gray-700 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-10",children:u.jsxs("div",{className:"px-1 py-1 ",children:[u.jsx(j,{label:"Asignar y procesar",onClick:()=>K.get(route("asignacion.create",e.id))}),u.jsx(j,{label:"Editar",onClick:()=>K.get(route("orders.edit",e.id))}),u.jsx(j,{label:"Eliminar",onClick:()=>handleDelete(e.id)}),u.jsx(j,{label:"Imprimir",onClick:()=>handlePrint(e.id)})]})})]}),Ye=({auth:e})=>{const[a,t]=c.useState([]),[n,o]=c.useState(1),[r,l]=c.useState(50),[s,m]=c.useState(1),[f,g]=c.useState(!1),[h,y]=c.useState(null),[S,R]=c.useState({factura:""}),p=async()=>{g(!0),y(null);try{const d=await ee.get(route("lista.pedidos"),{params:{page:n,per_page:r,estado:"Producción en curso",factura:S.factura||null}});t(d.data.data),o(d.data.current_page),m(d.data.total_pages),l(d.data.total_items)}catch(d){console.error("Error fetching data:",d),y("Hubo un error al cargar los datos.")}finally{g(!1)}};c.useEffect(()=>{p()},[n,r,S]);const I=c.useMemo(()=>[{header:"Factura",accessor:"factura"},{header:"Pedido",accessor:"id"},{header:"Cliente",accessor:"cliente.full_name",cell:d=>{var i;return((i=d.cliente)==null?void 0:i.full_name)||"N/A"}},{header:"Fecha de entrega",accessor:"fechaEntrega"},{header:"Estado",accessor:"estado"},{header:"Fecha de Ingreso",accessor:"created_at",cell:d=>new Date(d.created_at).toLocaleDateString("es-ES")},{header:"Acciones",cell:d=>u.jsx(Ue,{row:d})}],[]);return u.jsxs(te,{user:e.user,header:u.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Asignación de Pedidos"}),children:[u.jsx(Z,{title:"Asignar Pedidos"}),u.jsxs(re,{children:[u.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Pedidos Pendientes"}),u.jsx(ae,{placeholder:"Buscar  factura",onChange:d=>R(i=>({...i,factura:d.target.value}))}),f?u.jsx("div",{className:"text-center py-10",children:"Cargando..."}):h?u.jsx("div",{className:"text-center py-10 text-red-500",children:h}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[u.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:u.jsx("tr",{children:I.map((d,i)=>u.jsx("th",{className:"px-6 py-3 whitespace-nowrap",children:d.header},i))})}),u.jsx("tbody",{children:a.length>0?a.map((d,i)=>u.jsx("tr",{className:"bg-white dark:bg-gray-800 border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:I.map((D,M)=>u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:D.cell?D.cell(d):d[D.accessor]||"N/A"},M))},i)):u.jsx("tr",{children:u.jsx("td",{colSpan:I.length,className:"px-6 py-4 text-center",children:"No hay datos disponibles."})})})]})}),u.jsxs("div",{className:"flex items-center justify-between mt-4",children:[u.jsxs("div",{children:["Mostrando página ",n," de ",s]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>o(d=>Math.max(d-1,1)),disabled:n===1||f,className:_("px-4 py-2 rounded-md",n===1||f?"bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-400 dark:hover:bg-gray-500"),children:"Anterior"}),u.jsx("button",{onClick:()=>o(d=>Math.min(d+1,s)),disabled:n===s||f,className:_("px-4 py-2 rounded-md",n===s||f?"bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-400 dark:hover:bg-gray-500"),children:"Siguiente"})]})]})]})]})};export{Ye as default};
